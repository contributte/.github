name: "Composer"
description: "Setup Composer"

inputs:
  command:
    required: false
    type: string
    default: "composer update --no-interaction --no-progress --prefer-dist --prefer-stable"

runs:
  using: "composite"

  steps:
    - name: "Get Composer cache directory"
      id: "composercache"
      shell: "bash"
      run: 'echo "::set-output name=dir::$(composer config cache-files-dir)"'

    - name: "Cache PHP dependencies"
      uses: "actions/cache@v2"
      with:
        path: "${{ steps.composercache.outputs.dir }}"
        key: "${{ runner.os }}-composer-${{ hashFiles('**/composer.json') }}"
        restore-keys: "${{ runner.os }}-composer-"

    - name: "Install Composer dependencies"
      shell: "bash"
      run: "${{ inputs.command }}"